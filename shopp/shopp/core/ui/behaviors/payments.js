/*
 * payments.js - Payment method settings UI behaviors
 * Copyright ?? 2011 by Ingenesis Limited. All rights reserved.
 * Licensed under the GPLv3 {@see license.txt}
 */
jQuery(document).ready(function(d){d.each(gateways,function(f,g){d.template(g+"-editor",d("#"+g+"-editor"))});var b=false,e=d("#payment-option-menu"),c=d("#no-payment-settings"),a=function(k){if(k){k.preventDefault()}if(b){b.cancel(false)}c.hide();var l=d(this),q=l.parents("tr").hide(),i=e.val().toLowerCase(),f=l.attr("href")?l.attr("href").split("&")[1].split("=")[1].toLowerCase().split("-"):false,p=f?f[0]:i,n=f?f[1]:0,h=!f&&$ps[p]?d.each($ps[p],function(r,s){if(!isNaN(r)){n++}}):false,j=$ps[p]&&$ps[p][n]?d.extend($ps[p][n],{instance:n}):d.extend($ps[p],{instance:n}),m=d.tmpl(p+"-editor",j),o=m.find("a.cancel"),g=m.find("input.selectall-toggle").change(function(t){var s=d(this),r=s.parents("ul").find("input");r.attr("checked",s.attr("checked"))});if(q.size()==0){q=d("#payment-setting-"+f).hide()}e.get(0).selectedIndex=0;l.cancel=function(r){if(r){r.preventDefault()}b=false;m.remove();q.fadeIn("fast");if(c.size()>0){c.show()}};o.click(l.cancel);if(q.size()>0){m.insertAfter(q)}else{m.prependTo("#payments-settings-table")}d(document).trigger(p+"Settings",[m]);b=l};d("#payments a.edit").click(a);d("#payment-option-menu").change(a);d("#payments a.delete").click(function(){if(confirm($ps.confirm)){return true}else{return false}})});